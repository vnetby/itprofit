!function(t){var e={};function a(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=e,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=8)}([function(t,e,a){},function(t,e){Array.prototype.filter||(Array.prototype.filter=function(t){"use strict";if(null==this)throw new TypeError;var e=Object(this),a=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var i=[],n=arguments.length>=2?arguments[1]:void 0,o=0;o<a;o++)if(o in e){var s=e[o];t.call(n,s,o,e)&&i.push(s)}return i})},function(t,e){Array.prototype.find||(Array.prototype.find=function(t){"use strict";if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,a=Object(this),i=a.length>>>0,n=arguments[1],o=0;o<i;o++)if(e=a[o],t.call(n,e,o,a))return e})},function(t,e){var a;a={}},function(t,e,a){(function(t){t.CROP_THUMBNAILS_VUE={app:null,components:{}}}).call(this,a(5))},function(t,e){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch(t){"object"==typeof window&&(a=window)}t.exports=a},function(t,e){CROP_THUMBNAILS_DO_CACHE_BREAK=function(t){for(var e=jQuery,a=e(t),i=0;i<a.length;i++){var n=e(a[i]),o=n.attr("src").split("?");n.attr("src",o[0]+"?&cacheBreak="+(new Date).getTime())}}},function(t,e){jQuery(document).ready((function(t){t(document).on("click",".cropThumbnailsLink",(function(e){e.preventDefault();var a=t(this).data("cropthumbnail"),i=t(this).attr("title"),n=null;void 0!==a.posttype&&(n=a.posttype),(new CROP_THUMBNAILS_VUE.modal).open(a.image_id,n,i)}))}))},function(t,e,a){"use strict";a.r(e);a(0),a(1),a(2),a(3),a(4),a(6),a(7);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.cropData&&t.lang?a("div",{staticClass:"cptEditorInner",class:{loading:t.loading,cropEditorActive:t.croppingApi}},[t.loading?a("div",{staticClass:"cptWaitingWindow"},[a("div",{staticClass:"msg"},[t._v("\n            "+t._s(t.lang.waiting)+"\n            "),t._m(0)])]):t._e(),t._v(" "),t.cropData.hiddenOnPostType?a("div",{staticClass:"cptWaitingWindow cptCropDisabledMsg"},[a("div",{staticClass:"msg"},[t._v(t._s(t.lang.cropDisabled))])]):t._e(),t._v(" "),t.cropData.noPermission?a("div",{staticClass:"cptWaitingWindow cptNoPermissionMsg"},[a("div",{staticClass:"msg"},[t._v(t._s(t.lang.noPermission))])]):t._e(),t._v(" "),t.cropData.hiddenOnPostType||t.cropData.noPermission?t._e():a("div",{staticClass:"mainWindow"},[a("div",{staticClass:"cptSelectionPane",class:{cptImagesAreSelected:t.activeImageSizes.length>0}},[a("div",{staticClass:"cptSelectionPaneInner"},[t.sourceImageHasOrientation?a("message",[t._v(t._s(t.lang.message_image_orientation))]):t._e(),t._v(" "),a("p",[a("label",{staticClass:"cptSameRatioLabel"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.selectSameRatio,expression:"selectSameRatio"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.selectSameRatio)?t._i(t.selectSameRatio,null)>-1:t.selectSameRatio},on:{change:function(e){var a=t.selectSameRatio,i=e.target,n=!!i.checked;if(Array.isArray(a)){var o=t._i(a,null);i.checked?o<0&&(t.selectSameRatio=a.concat([null])):o>-1&&(t.selectSameRatio=a.slice(0,o).concat(a.slice(o+1)))}else t.selectSameRatio=n}}}),t._v("\n                        "+t._s(t.lang.label_same_ratio)+"\n                    ")]),t._v(" "),a("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.makeAllInactive()}}},[t._v(t._s(t.lang.label_deselect_all))])]),t._v(" "),a("ul",{staticClass:"cptImageSizelist"},t._l(t.filteredImageSizes,(function(e){return a("li",{key:e.nameLabel,class:t.imageSizeClass(e),on:{click:function(a){return t.toggleActive(e)}}},[a("section",{staticClass:"cptImageSizeInner"},[a("header",[t._v(t._s(e.nameLabel))]),t._v(" "),t.isLowRes(e)?a("div",{staticClass:"lowResWarning",attrs:{title:t.lang.lowResWarning}},[a("span",[t._v("!")])]):t._e(),t._v(" "),t.isLowRes(e)||e.url!==t.cropData.sourceImage.full.url?t._e():a("div",{staticClass:"notYetCropped",attrs:{title:t.lang.notYetCropped}},[a("span",{staticClass:"dashicons dashicons-image-crop"})]),t._v(" "),a("div",{staticClass:"dimensions"},[t._v(t._s(t.lang.dimensions)+" "+t._s(e.width)+" x "+t._s(e.height)+" "+t._s(t.lang.pixel))]),t._v(" "),a("div",{staticClass:"ratio"},[t._v(t._s(t.lang.ratio)+" "+t._s(e.printRatio))]),t._v(" "),a("loadingcontainer",{attrs:{image:e.url+"?cacheBreak="+e.cacheBreak}},[a("div",{staticClass:"cptImageBgContainer",style:{"background-image":"url("+e.url+"?cacheBreak="+e.cacheBreak+")"}})])],1)])})),0)],1)]),t._v(" "),a("div",{staticClass:"cptCropPane"},[a("div",{staticClass:"info"},[a("h3",[t._v(t._s(t.lang.rawImage))]),t._v(" "),a("div",{staticClass:"dimensions"},[t._v(t._s(t.lang.dimensions)+" "+t._s(t.cropData.sourceImage.full.width)+" x "+t._s(t.cropData.sourceImage.full.height)+" "+t._s(t.lang.pixel))]),t._v(" "),a("div",{staticClass:"ratio"},[t._v(t._s(t.lang.ratio)+" "+t._s(t.cropData.sourceImage.full.printRatio))])]),t._v(" "),a("button",{staticClass:"button cptGenerate",class:{"button-primary":t.croppingApi},attrs:{type:"button",disabled:!t.croppingApi},on:{click:function(e){return t.cropThumbnails()}}},[t._v(t._s(t.lang.label_crop))]),t._v(" "),a("div",{staticClass:"cropContainer"},[a("img",{staticClass:"cptCroppingImage",attrs:{src:t.cropImage.url}})]),t._v(" "),a("h4",[t._v(t._s(t.lang.instructions_header))]),t._v(" "),a("ul",{staticClass:"step-info"},[a("li",[t._v(t._s(t.lang.instructions_step_1))]),t._v(" "),a("li",[t._v(t._s(t.lang.instructions_step_2))]),t._v(" "),a("li",[t._v(t._s(t.lang.instructions_step_3))])]),t._v(" "),a("div",[t.cropData.options.debug_js?a("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.showDebugClick("js")}}},[t._v("show JS-Debug")]):t._e(),t._v(" "),t.cropData.options.debug_data&&null!==t.dataDebug?a("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.showDebugClick("data")}}},[t._v("show Data-Debug")]):t._e(),t._v(" "),"data"===t.showDebugType?a("pre",[t._v(t._s(t.dataDebug))]):t._e(),t._v(" "),"js"===t.showDebugType?a("pre",[a("br"),t._v("cropImage:"+t._s(t.cropImage)),a("br"),t._v("cropData:"+t._s(t.cropData))]):t._e()])])])]):t._e()};i._withStripped=!0;var n=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"loadingcontainer",class:this.status},[e("img",{staticStyle:{display:"none"},attrs:{src:this.image}}),this._v(" "),this._t("default"),this._v(" "),e("transition",{attrs:{name:"fade"}},["loading"===this.status?e("div",{staticClass:"loadingMsg"},[e("div",{staticClass:"cptLoadingSpinner"})]):this._e()])],2)};function o(t,e,a,i,n,o,s,r){var c,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=a,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=r?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(t,e){return c.call(e),u(t,e)}}else{var p=l.beforeCreate;l.beforeCreate=p?[].concat(p,c):[c]}return{exports:t,options:l}}n._withStripped=!0;var s=o({props:{image:{required:!0,type:String}},data:function(){return{status:null}},watch:{image:function(){this.setup()}},mounted:function(){this.setup()},methods:{setup:function(){var t=this;t.setStart(),setTimeout((function(){imagesLoaded(t.$el).once("done",(function(){"failed"!==t.status&&t.setComplete()})).once("fail",(function(){t.setFailed()}))}),300)},setComplete:function(){this.status="completed"},setStart:function(){this.status="loading"},setFailed:function(){this.status="failed"}}},n,[],!1,null,null,null);s.options.__file="components/loadingcontainer.vue";var r=s.exports,c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.closed?t._e():a("div",{staticClass:"notice notice-warning is-dismissible cptMessage",attrs:{"aria-role":"alert"}},[a("p",[t._t("default")],2),t._v(" "),a("button",{staticClass:"notice-dismiss",attrs:{type:"button","aria-label":"close"},on:{click:function(e){return t.close()}}})])};c._withStripped=!0;var l=o({props:{},data:function(){return{closed:!1}},methods:{close:function(){this.closed=!0}}},c,[],!1,null,null,null);l.options.__file="components/message.vue";var u=l.exports,p=o({props:{imageId:{required:!0,type:Number},posttype:{required:!1,type:String,default:null}},components:{loadingcontainer:r,message:u},data:function(){return{cropData:null,loading:!1,selectSameRatio:!0,croppingApi:null,currentCropSize:null,lang:null,nonce:null,showDebugType:null,dataDebug:null}},mounted:function(){this.loadCropData()},computed:{cropImage:function(){if(void 0!==this.cropData){var t=this.cropData.sourceImage.full,e=Math.round(10*t.ratio);return null!==this.cropData.sourceImage.large&&this.cropData.sourceImage.large.width>745&&e===Math.round(10*this.cropData.sourceImage.large.ratio)&&this.cropData.sourceImage.full.url!==this.cropData.sourceImage.large.url&&(t=this.cropData.sourceImage.large),null!==this.cropData.sourceImage.medium_large&&this.cropData.sourceImage.medium_large.width>745&&e===Math.round(10*this.cropData.sourceImage.medium_large.ratio)&&this.cropData.sourceImage.full.url!==this.cropData.sourceImage.medium_large.url&&(t=this.cropData.sourceImage.medium_large),t}},filteredImageSizes:function(){return this.cropData.imageSizes.filter((function(t){return!t.hideByPostType}))},activeImageSizes:function(){return this.cropData.imageSizes.filter((function(t){return t.active}))},sourceImageHasOrientation:function(){try{if("string"==typeof this.cropData.sourceImageMeta.orientation&&"1"!==this.cropData.sourceImageMeta.orientation&&"0"!==this.cropData.sourceImageMeta.orientation)return!0}catch(t){}return!1}},methods:{imageSizeClass:function(t){var e={active:t.active};return e["cptImageSize-"+t.nameLabel]=!0,e},loadCropData:function(){var t=this,e={action:"cpt_cropdata",imageId:this.imageId,posttype:this.posttype};t.loading=!0,jQuery.get(ajaxurl,e,(function(e){t.makeAllInactive(e.imageSizes),t.addCacheBreak(e.imageSizes),t.cropData=e,t.lang=t.cropData.lang,t.nonce=t.cropData.nonce,delete t.cropData.nonce})).fail((function(e){t.cropData=e.responseJSON,t.lang=t.cropData.lang,t.nonce=t.cropData.nonce,delete t.cropData.nonce,403===e.status&&(t.cropData.noPermission=!0)})).always((function(){t.loading=!1}))},isLowRes:function(t){return!(!t.active||null===this.currentCropSize)&&(0===t.width&&this.currentCropSize.height<t.height||(0===t.height&&this.currentCropSize.width<t.width||(9999===t.height?this.currentCropSize.width<t.width:9999===t.width?this.currentCropSize.height<t.height:this.currentCropSize.width<t.width||this.currentCropSize.height<t.height)))},toggleActive:function(t){var e=!t.active;!1===t.active&&this.makeAllInactive(),this.selectSameRatio?this.cropData.imageSizes.forEach((function(a){a.printRatio===t.printRatio&&!1===a.hideByPostType&&(a.active=e)})):t.active=e,this.activeImageSizes.length>0?this.activateCropArea():this.deactivateCropArea()},makeAllInactive:function(t){void 0===t&&(t=this.cropData.imageSizes),t.forEach((function(t){t.active=!1,t.lowResWarning=!1})),this.deactivateCropArea()},addCacheBreak:function(t){void 0===t&&(t=this.cropData.imageSizes),t.forEach((function(t){t.cacheBreak=Date.now()}))},updateCurrentCrop:function(){var t=null;if(null!==this.croppingApi){var e=this.croppingApi.tellSelect();t={width:Math.round(e.w),height:Math.round(e.h)}}this.currentCropSize=t},activateCropArea:function(){var t=this;t.deactivateCropArea();var e,a,i,n,o,s,r,c={trueSize:[t.cropData.sourceImage.full.width,t.cropData.sourceImage.full.height],aspectRatio:0,setSelect:[],onSelect:t.updateCurrentCrop};t.activeImageSizes.forEach((function(t){0===c.aspectRatio&&(c.aspectRatio=t.ratio),c.aspectRatio!==t.ratio&&console.info('Crop Thumbnails: print ratio is different from normal ratio on image size "'+t.name+'".')})),c.setSelect=(e=t.cropData.sourceImage.full.width,a=t.cropData.sourceImage.full.height,i=c.aspectRatio,n=0,o=0,s=e,r=a,e/a<=i?r=a-(o=a/2-e/i/2):s=e-(n=e/2-a*i/2),[n,o,s,r]),t.cropData.options.debug_js&&console.info("Cropping options",c),jQuery(t.$el).find("img.cptCroppingImage").Jcrop(c,(function(){t.croppingApi=this,t.updateCurrentCrop()}))},deactivateCropArea:function(){null!==this.croppingApi&&(this.croppingApi.destroy(),this.croppingApi=null,this.currentCropSize=null)},showDebugClick:function(t){this.showDebugType===t?this.showDebugType=null:this.showDebugType=t},cropThumbnails:function(){var t,e=this;if(!e.loading&&null!==e.croppingApi){e.loading=!0;var a={action:"cptSaveThumbnail",_ajax_nonce:e.nonce,cookie:encodeURIComponent(document.cookie),crop_thumbnails:JSON.stringify({selection:e.croppingApi.tellSelect(),sourceImageId:e.cropData.sourceImageId,activeImageSizes:(t=[],e.activeImageSizes.forEach((function(e){if(e.active){var a={name:e.name,width:e.width,height:e.height,ratio:e.ratio,crop:e.crop};t.push(a)}})),t)})};jQuery.post(ajaxurl,a,null,"json").done((function(t){if(e.cropData.options.debug_data&&(e.dataDebug=t.debug,console.log("Save Function Debug",t.debug)),void 0===t.error)return void 0!==t.success?(void 0!==t.changedImageName&&e.activeImageSizes.forEach((function(e,a){void 0!==t.changedImageName[e.name]&&(e.url=t.changedImageName[e.name])})),void e.addCacheBreak(e.activeImageSizes)):void 0;alert(t.error)})).fail((function(t){alert(e.lang.script_connection_error);var i={status:t.status,statusText:t.statusText,requestUrl:ajaxurl,requestParams:a};console.error("crop-thumbnails connection error",i)})).always((function(){e.loading=!1}))}}}},i,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"cptLoadingSpinner"})])}],!1,null,null,null);p.options.__file="components/cropeditor.vue";var d=p.exports;CROP_THUMBNAILS_VUE.modal=function(){var t=jQuery,e=this;e.close=function(a){CROP_THUMBNAILS_VUE.app.$destroy(),CROP_THUMBNAILS_VUE.app=null,t("#cpt_Modal .cpt_ModalClose, #cpt_Modal").unbind("click"),t("#cpt_Modal").remove(),t("body").removeClass("cpt_ModalIsOpen"),t("body").trigger("cropThumbnailModalClosed"),document.removeEventListener("keydown",e.closeByEscKey,!0)},e.closeByBackground=function(t){t.target==document.getElementById("cpt_Modal")&&e.close(t)},e.closeByEscKey=function(t){t.keyCode&&27!==t.keyCode||(t.stopPropagation(),e.close(t))},e.open=function(a,i,n){var o=a,s="";s+='<div id="cpt_Modal" class="cpt_Modal">',s+='<div class="cpt_ModalDialog" role="dialog" aria-label="'+t("<div>").text(n).html()+'">',s+='<button type="button" class="cpt_ModalClose" aria-label="close">&times;</button>',s+='<div class="cpt_ModalHeader"><div class="cpt_ModalTitle">'+n+"</div></div>",s+='<div class="cpt_ModalContent" id="cpt_crop_editor">',s+='<cropeditor :image-id="'+o+'"',"string"==typeof i&&(s+=' posttype="'+i+'"'),s+="></cropeditor>",s+="</div>",s+="</div>",s+="</div>",t("body").prepend(s).addClass("cpt_ModalIsOpen"),t("#cpt_Modal .cpt_ModalClose").click(e.close),t("#cpt_Modal").on("touchstart mousedown",e.closeByBackground),document.addEventListener("keydown",e.closeByEscKey,!0),CROP_THUMBNAILS_VUE.app=new Vue({el:"#cpt_crop_editor",mounted:function(){console.log("cpt_crop_editor mounted")},components:{cropeditor:d}})}};var g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"cptSettingsPostListDescription"},[t._v(t._s(t.settingsData.lang.choose_image_sizes))]),t._v(" "),a("ul",{staticClass:"cptSettingsPostList"},t._l(t.settingsData.post_types,(function(e){return a("li",{key:e.name},[e?a("section",[a("header",[a("h3",[t._v(t._s(e.label))])]),t._v(" "),a("ul",{staticClass:"cptImageSizes"},[t._l(t.settingsData.image_sizes,(function(i){return[i.crop?a("li",{key:i.id},[a("label",[a("input",{attrs:{type:"checkbox",name:"crop-post-thumbs[hide_size]["+e.name+"]["+i.id+"]"},domProps:{value:i.id,checked:t.isImageSizeHidden(e.name,i.id)}}),t._v(" "),a("span",{staticClass:"name"},[t._v(t._s(i.name))]),t._v(" "),i.name!==i.id?a("span",{staticClass:"defaultName"},[t._v("("+t._s(i.id)+")")]):t._e()])]):t._e()]}))],2),t._v(" "),a("label",[a("input",{attrs:{id:"cpt_settings_post",type:"checkbox",name:"crop-post-thumbs[hide_post_type]["+e.name+"]",value:"1"},domProps:{checked:t.isButtonHiddenOnPostType(e.name)}}),t._v("\n                    "+t._s(t.settingsData.lang.hide_on_post_type)+"\n                ")])]):t._e()])})),0)])};g._withStripped=!0;var _=o({props:{settings:{required:!0}},components:{},data:function(){return{settingsData:JSON.parse(this.settings)}},mounted:function(){},computed:{},methods:{isButtonHiddenOnPostType:function(t){return this.settingsData.options&&this.settingsData.options.hide_post_type&&"1"===this.settingsData.options.hide_post_type[t]},isImageSizeHidden:function(t,e){return this.settingsData.options&&this.settingsData.options.hide_size&&this.settingsData.options.hide_size[t]&&"1"===this.settingsData.options.hide_size[t][e]}}},g,[],!1,null,null,null);_.options.__file="components/settingsscreen.vue";var h=_.exports;jQuery(document).ready((function(t){t("body.settings_page_page-cpt").length>0&&(CROP_THUMBNAILS_VUE.app=new Vue({el:"#cpt_settings_settingsscreen",mounted:function(){console.log("cpt_settings_settingsscreen mounted")},components:{cptSettingsscreen:h}}))}))}]);